<!DOCTYPE html>
<html lang="en" >

<head>
    <meta charset="UTF-8"><meta http-equiv="Content-Security-Policy"
content="default-src 'self';font-src &#x27;self&#x27; data:;img-src &#x27;self&#x27; https:&#x2F;&#x2F;* data:;media-src &#x27;self&#x27;;style-src &#x27;self&#x27;;frame-src player.vimeo.com https:&#x2F;&#x2F;www.youtube-nocookie.com;connect-src 'self';script-src 'self' 'self'">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="base" content="http://vsbabu.org/twenties">

    
    <title>~sv • Gmail : GUI for your backend!</title>

    
    
        <link rel="icon" type="image/png" href="http://vsbabu.org/twenties/favicon.ico"/>
    
    

    
    
        
            
            
                
                    <link rel="alternate" type="application/atom+xml" title="~sv - Atom Feed" href="http://vsbabu.org/twenties/atom.xml">
                
            
        
    

    
    
    
        
            <link rel="stylesheet" href="http://vsbabu.org/twenties/custom_subset.css?h=0b9535a28bc3d5bf2321">
        
    

    
        <link rel="stylesheet" href="http://vsbabu.org/twenties/main.css?h=e38cfa6902d00356cd66" />
        <link rel="stylesheet" href="http://vsbabu.org/twenties/skins/lavender.css?h=31ee0a710ed660d122f6" />

    <meta name="color-scheme" content="light dark" />
        <meta name="description" content="Why build an app if you can use GMAIL to get data?" />
        <meta property="og:description" content="Why build an app if you can use GMAIL to get data?" />

    

    <meta property="og:title" content="Gmail : GUI for your backend!" />
    <meta property="og:type" content="article" />

    
<meta property="og:locale" content="en_GB" />

    <meta property="og:url" content="http:&#x2F;&#x2F;vsbabu.org&#x2F;twenties&#x2F;blog&#x2F;gmail_fetchproc&#x2F;" /><meta property="og:site_name" content="~sv">
        <noscript><link rel="stylesheet" href="http://vsbabu.org/twenties/no_js.css"/></noscript>
        <script type="text/javascript" src="http://vsbabu.org/twenties/js/initializeTheme.min.js"></script>
        <script defer src="http://vsbabu.org/twenties/js/themeSwitcher.min.js"></script>
        <script defer src="http://vsbabu.org/twenties/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e"></script>

        </head>


<body>
    <header>
    <nav class="navbar">
        <div class="nav-title">
            <a class="home-title" href="http://vsbabu.org/twenties">~sv</a>
        </div>
            <div class="nav-navs">
                <ul>
                        
                            <li>
                                <a class="nav-links no-hover-padding" href="http://vsbabu.org/twenties/../">home
                                </a>
                            </li>
                        
                            <li>
                                <a class="nav-links no-hover-padding" href="http://vsbabu.org/twenties/blog/">blog
                                </a>
                            </li>
                        
                            <li>
                                <a class="nav-links no-hover-padding" href="http://vsbabu.org/twenties/archive/">archive
                                </a>
                            </li>
                        
                            <li>
                                <a class="nav-links no-hover-padding" href="http://vsbabu.org/twenties/tags/">tags
                                </a>
                            </li>
                        
                            <li>
                                <a class="nav-links no-hover-padding" href="http://vsbabu.org/twenties/about/">about
                                </a>
                            </li>
                        <li class="menu-icons-container">
                        <ul class="menu-icons-group">
                            <li class="js menu-icon">
                                <div role="button" tabindex="0" id="search-button" class="search-icon interactive-icon" title="Click or press $SHORTCUT to open search" aria-label="Click or press $SHORTCUT to open search">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                                        <path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/>
                                    </svg>
                                </div>
                            </li>

                            
                            

                            <li class="theme-switcher-wrapper js"><div
        title="Toggle dark&#x2F;light mode"
        class="theme-switcher"
        tabindex="0"
        role="button"
        aria-label="Toggle dark mode"
        aria-pressed="false">
    </div><div
        title="Reset mode to default"
        class="theme-resetter arrow"
        tabindex="0"
        role="button"
        aria-hidden="true"
        aria-label="Reset mode to default">
    </div>

</li>
</ul>
                    </li>
                </ul>
            </div>
        
    </nav>
</header>

    <div class="content">

        
        




<main>
    <article>
        <h1 class="article-title">
            Gmail : GUI for your backend!
        </h1>

        <ul class="meta">
                <li>27th Mar 2020</li><li title="488 words"><span class='separator' aria-hidden='true'>•</span>3 min read</li><li class="tag"><span class='separator' aria-hidden='true'>•</span>Tags:&nbsp;</li><li class="tag"><a href="http://vsbabu.org/twenties/tags/unix/">unix</a>,&nbsp;</li><li class="tag"><a href="http://vsbabu.org/twenties/tags/utilities/">utilities</a>,&nbsp;</li><li class="tag"><a href="http://vsbabu.org/twenties/tags/snippet/">snippet</a></li>
        </ul>

        <section class="body"><p>Often, we have a need to collect data from customers. Immediate thinking is to
make an app change, push it up to store, get people to upgrade (doesn’t
happen!) and then pray. A little more savvy version of this is making a web app
and then send the links with a uuid based customer identification.</p>
<p>Why not just ask users to email you the data? People know how to use email! Following snippet shows  how easy
it is to automate fetching the data and then sending to a script to process.</p>
<span id="continue-reading"></span><h2 id="How?"><a class="header-anchor no-hover-padding" href="#How?" aria-label="Anchor link for: How?"><span class="link-icon" aria-hidden="true"></span></a>
How?</h2>
<p>Two venerable unix utilities.</p>
<ul>
<li><a href="https://www.fetchmail.info">fetchmail</a> supports a wide variety of protocols
to get email from a remote email server.</li>
<li><a href="https://wiki.archlinux.org/index.php/Procmail">procmail</a> do something with
your email. Including routing to specific mailboxes or <em>commands</em>.</li>
</ul>
<h2 id="Setup"><a class="header-anchor no-hover-padding" href="#Setup" aria-label="Anchor link for: Setup"><span class="link-icon" aria-hidden="true"></span></a>
Setup</h2>
<p>If you are in recent <em>ubuntu</em> or its derivates, just install these two.</p>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">sudo</span></span><span class="z-meta z-function-call z-arguments z-shell"> apt-get install fetchmail fetchmailconf procmail</span>
</span></code></pre>
<h2 id="Config"><a class="header-anchor no-hover-padding" href="#Config" aria-label="Anchor link for: Config"><span class="link-icon" aria-hidden="true"></span></a>
Config</h2>
<p>Let us create a <em>fetchmail</em> config file to get data from gmail.</p>
<h3 id="Gmail"><a class="header-anchor no-hover-padding" href="#Gmail" aria-label="Anchor link for: Gmail"><span class="link-icon" aria-hidden="true"></span></a>
Gmail</h3>
<p>First, <a href="https://support.google.com/a/answer/9003945?hl=en&amp;ref_topic=4456189">Configure gmail to support
imap</a>.</p>
<p>To make things easier, you should also setup a gmail filter to move
emails matching your criteria to a label, from inbox. This way, we can
have multiple configs for multiple use cases all using same gmail account.</p>
<p>For example, I have one gmail account called <em>myemail@mydomain.com</em>. So, for
usecase A, I ask people to email to <em>myemail</em>+a@mydomain.com_ and for usecase
B, they send to myemail_+B@mydomain.com_. In gmail, you simply add filters
based on <em>To:</em> field in the incoming mail.</p>
<h3 id="Fetchmail"><a class="header-anchor no-hover-padding" href="#Fetchmail" aria-label="Anchor link for: Fetchmail"><span class="link-icon" aria-hidden="true"></span></a>
Fetchmail</h3>
<p>fetchmail.rc is below.</p>
<pre class="z-code"><code><span class="z-text z-plain">poll imap.gmail.com protocol IMAP
</span><span class="z-text z-plain">   user &quot;myemail@mydomain.com&quot; is localuser here
</span><span class="z-text z-plain">   password &#39;whateveritis&#39;
</span><span class="z-text z-plain">   folder &#39;mygmaillabel&#39;
</span><span class="z-text z-plain">   fetchall
</span><span class="z-text z-plain">   keep
</span><span class="z-text z-plain">   ssl
</span></code></pre>
<ul>
<li><code>fetchall</code> indicates we should get all unread mails from this folder.</li>
<li><code>keep</code> ensures mails are left on the server and not deleted. You can
use <code>nokeep</code> if you want to delete the mails we’ve downloaded.</li>
</ul>
<h3 id="Procmail"><a class="header-anchor no-hover-padding" href="#Procmail" aria-label="Anchor link for: Procmail"><span class="link-icon" aria-hidden="true"></span></a>
Procmail</h3>
<p>procmail.rc is below.</p>
<pre class="z-code"><code><span class="z-text z-plain">VERBOSE=0
</span><span class="z-text z-plain">:0
</span><span class="z-text z-plain">! `/full/path/to/processemail.py`
</span></code></pre>
<p>What this is doing is that every email that comes to <em>procmail</em> will be passed
to this script <em>processemail.py</em> via stdin. There are many samples out there -
for example, <a href="https://gist.github.com/baali/2633554">download attachments</a>
using the cool <em>walk</em> method.</p>
<p>Most of the examples also have code for reading from gmail directly, but I
prefer keeping <em>getting data</em> and <em>processing data</em> as separate things.</p>
<p>Note that the configuration above is completely reliant on the script - if your
script has an error and threw out the content, then <em>fetchmail</em> would have
marked the mail as read and you would’ve lost the content from local.</p>
<h2 id="Integration"><a class="header-anchor no-hover-padding" href="#Integration" aria-label="Anchor link for: Integration"><span class="link-icon" aria-hidden="true"></span></a>
Integration</h2>
<p>Just execute a command as below.</p>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">fetchmail</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>f</span> fetchmail.rc <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">  --</span>mda</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">&quot;</span>procmail <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-punctuation z-section z-expansion z-parameter z-begin z-shell">{</span></span><span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-variable z-other z-readwrite z-shell">PWD</span></span><span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-section z-expansion z-parameter z-end z-shell">}</span></span>/procmail.rc<span class="z-punctuation z-definition z-string z-end z-shell">&quot;</span></span></span>
</span></code></pre>
<p>Straight forward,  isn’t it? Get the mail and send to mail delivery agent,
which is <em>procmail</em> using your config.</p>
<p>Add this to a cron and you are done. <em>fetchmail</em> comes with its own daemon mode
too if you prefer that route.</p>
<p>I like to cron things on my own since for different use cases, I have different
config files. It is far easier that way than  adding multiple filters in
procmail to direct to different scripts.</p>

        </section>

        
                
                
                    
                        
                        
                        
                    
                    
                        
                        
                        
                    
                
                
            <nav class="full-width article-navigation">
                <div><a href="http://vsbabu.org/twenties/blog/leo_rst_sphinx/" aria-label="Next" aria-describedby="left_title"><span class="arrow">←</span>&nbsp;Next</a>
                <p aria-hidden="true" id="left_title">Leo + Sphinx = painless documentation</p></div>
                <div><a href="http://vsbabu.org/twenties/blog/calmap_vis/" aria-label="Prev" aria-describedby="right_title">Prev&nbsp;<span class="arrow">→</span></a>
                <p aria-hidden="true" id="right_title">Calendar Heatmaps from Dataframes</p></div>
            </nav>
        
        

        
            
            
            

            
        
            
            
            

            
        
            
            
            

            
        
            
            
            

            
        
        

    </article>
</main>

    <div id="button-container">
        
        
            <div id="toc-floating-container">
                <input type="checkbox" id="toc-toggle" class="toggle"/>
                <label for="toc-toggle" class="overlay"></label>
                <label for="toc-toggle" id="toc-button" class="button" title="Toggle Table of Contents">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960"><path d="M414.82-193.094q-18.044 0-30.497-12.32-12.453-12.319-12.453-30.036t12.453-30.086q12.453-12.37 30.497-12.37h392.767q17.237 0 29.927 12.487 12.69 12.486 12.69 30.203 0 17.716-12.69 29.919t-29.927 12.203H414.82Zm0-244.833q-18.044 0-30.497-12.487Q371.87-462.9 371.87-480.45t12.453-29.92q12.453-12.369 30.497-12.369h392.767q17.237 0 29.927 12.511 12.69 12.512 12.69 29.845 0 17.716-12.69 30.086-12.69 12.37-29.927 12.37H414.82Zm0-245.167q-18.044 0-30.497-12.32t-12.453-30.037q0-17.716 12.453-30.086 12.453-12.369 30.497-12.369h392.767q17.237 0 29.927 12.486 12.69 12.487 12.69 30.203 0 17.717-12.69 29.92-12.69 12.203-29.927 12.203H414.82ZM189.379-156.681q-32.652 0-55.878-22.829t-23.226-55.731q0-32.549 23.15-55.647 23.151-23.097 55.95-23.097 32.799 0 55.313 23.484 22.515 23.484 22.515 56.246 0 32.212-22.861 54.893-22.861 22.681-54.963 22.681Zm0-245.167q-32.652 0-55.878-23.134-23.226-23.135-23.226-55.623 0-32.487 23.467-55.517t56.12-23.03q32.102 0 54.721 23.288 22.62 23.288 22.62 55.775 0 32.488-22.861 55.364-22.861 22.877-54.963 22.877Zm-.82-244.833q-32.224 0-55.254-23.288-23.03-23.289-23.03-55.623 0-32.333 23.271-55.364 23.272-23.03 55.495-23.03 32.224 0 55.193 23.288 22.969 23.289 22.969 55.622 0 32.334-23.21 55.364-23.21 23.031-55.434 23.031Z"/></svg>
                </label>
                <div class="toc-content">
                    

<div class="toc-container">
    

    <ul>
        
            
            
                <li><a href="http://vsbabu.org/twenties/blog/gmail_fetchproc/#How?">How?</a>
                    
                </li>
            
        
            
            
                <li><a href="http://vsbabu.org/twenties/blog/gmail_fetchproc/#Setup">Setup</a>
                    
                </li>
            
        
            
            
                <li><a href="http://vsbabu.org/twenties/blog/gmail_fetchproc/#Config">Config</a>
                    
                        <ul>
                            
                                
                                    <li><a href="http://vsbabu.org/twenties/blog/gmail_fetchproc/#Gmail">Gmail</a>
                                        
                                    </li>
                                
                            
                                
                                    <li><a href="http://vsbabu.org/twenties/blog/gmail_fetchproc/#Fetchmail">Fetchmail</a>
                                        
                                    </li>
                                
                            
                                
                                    <li><a href="http://vsbabu.org/twenties/blog/gmail_fetchproc/#Procmail">Procmail</a>
                                        
                                    </li>
                                
                            
                        </ul>
                    
                </li>
            
        
            
            
                <li><a href="http://vsbabu.org/twenties/blog/gmail_fetchproc/#Integration">Integration</a>
                    
                </li>
            
        
    </ul>
</div>


                </div>
            </div>
        

        
        

        
        <a href="#" id="top-button" class="no-hover-padding" title="Go to the top of the page">
            <svg viewBox="0 0 20 20" fill="currentColor"><path d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z"/></svg>
        </a>
    </div>


<span id="copy-success" class="hidden">
        Copied!
    </span>
    <span id="copy-init" class="hidden">
        Copy code to clipboard
    </span>
    <script defer src="http://vsbabu.org/twenties/js/copyCodeToClipboard.min.js"></script>
    </div>
    <footer>
    <section>
        <nav class="socials nav-navs"><ul><li>
                        <a class="nav-links no-hover-padding social" rel=""  href="http://vsbabu.org/twenties/atom.xml">
                        <img loading="lazy" alt="feed" title="feed" src="http://vsbabu.org/twenties/social_icons/rss.svg">
                        </a>
                    </li>
                        
                            <li>
                                <a class="nav-links no-hover-padding social" rel=" me"  href="https://github.com/vsbabu/">
                                    <img loading="lazy" alt="github" title="github" src="http://vsbabu.org/twenties/social_icons/github.svg">
                                </a>
                            </li>
                        
                            <li>
                                <a class="nav-links no-hover-padding social" rel=" me"  href="https://www.linkedin.com/in/vsbabu">
                                    <img loading="lazy" alt="linkedin" title="linkedin" src="http://vsbabu.org/twenties/social_icons/linkedin.svg">
                                </a>
                            </li>
                        
                            <li>
                                <a class="nav-links no-hover-padding social" rel=" me"  href="https://www.medium.com/@vsbabu">
                                    <img loading="lazy" alt="medium" title="medium" src="http://vsbabu.org/twenties/social_icons/matrix.svg">
                                </a>
                            </li>
                        
                            <li>
                                <a class="nav-links no-hover-padding social" rel=" me"  href="https://x.com/vsbabu">
                                    <img loading="lazy" alt="x" title="x" src="http://vsbabu.org/twenties/social_icons/x.svg">
                                </a>
                            </li>
                        
                            <li>
                                <a class="nav-links no-hover-padding social" rel=" me"  href="https://reddit.com/u/vsbabu">
                                    <img loading="lazy" alt="reddit" title="reddit" src="http://vsbabu.org/twenties/social_icons/reddit.svg">
                                </a>
                            </li>
                        
                    
                </ul>
            
        </nav>

        
        <nav class="nav-navs">
        </nav>

        <div class="credits">
            <small>
                

                
                Powered by
                <a rel=""  href="https://www.getzola.org">Zola</a>
                &amp;
                <a rel=""  href="https://github.com/welpo/tabi">tabi</a>

                </small>
        </div>
    </section>

    <div id="searchModal" class="search-modal js" role="dialog" aria-labelledby="modalTitle">
    <h1 id="modalTitle" class="visually-hidden">Search</h1>
    <div id="modal-content">
        <div id="searchBar">
            <div class="search-icon" aria-hidden="true">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                    <path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/>
                </svg>
            </div>
            <input id="searchInput" role="combobox" autocomplete="off" spellcheck="false" aria-expanded="false" aria-controls="results-container" placeholder="Search…"/>
            <div id="clear-search" class="close-icon interactive-icon" tabindex="0" role="button" title="Clear search">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                <path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/>
                </svg>
            </div>
        </div>
        <div id="results-container">
            <div id="results-info"><span id="zero_results"> No results</span>
                <span id="one_results"> $NUMBER result</span>
                <span id="many_results"> $NUMBER results</span><span id="two_results"> $NUMBER results</span>
                <span id="few_results"> $NUMBER results</span>
            </div>
            <div id="results" role="listbox"></div>
        </div>
    </div>
</div>
</footer>

</body>

</html>
